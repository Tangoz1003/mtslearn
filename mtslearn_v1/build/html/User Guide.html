<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>User Guide &#8212; mtslearn v1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="_static/basic_mod.css?v=59943e95" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=b30c7235"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/js/theme.js"></script>
    <script src="_static/js/petite-vue.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Quickstart" href="Quickstart.html" /> 
  </head><body data-dark_mode_code_blocks="true">

<div id="top_nav">
    

    <nav>
        
            
        

        <p id="toggle_sidebar">
            <a href="#" title="Toggle sidebar">|||</a>
        </p>
        <h1><a href="index.html" title="Go to homepage">mtslearn v1 documentation</a></h1>

        <a id="mode_toggle" href="#" @click.prevent="handleClick" :title="mode">
    <template v-if="mode == 'light'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_light"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M67.48,18.073c1.913,-1.912 1.913,-5.018 0,-6.931c-1.912,-1.912 -5.018,-1.912 -6.931,0l-6.798,6.799c-1.912,1.912 -1.912,5.018 0,6.931c1.913,1.912 5.018,1.912 6.931,-0l6.798,-6.799Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.728,61.108c1.912,-1.913 1.912,-5.018 -0,-6.931c-1.913,-1.913 -5.019,-1.913 -6.931,-0l-6.799,6.798c-1.912,1.913 -1.912,5.019 0,6.931c1.913,1.913 5.019,1.913 6.931,0l6.799,-6.798Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.682,54.177c-1.913,-1.913 -5.018,-1.913 -6.931,-0c-1.912,1.913 -1.912,5.018 0,6.931l6.798,6.798c1.913,1.913 5.019,1.913 6.931,0c1.913,-1.912 1.913,-5.018 0,-6.931l-6.798,-6.798Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M4.901,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,-0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M18.929,11.142c-1.912,-1.912 -5.018,-1.912 -6.931,0c-1.912,1.913 -1.912,5.019 0,6.931l6.799,6.799c1.912,1.912 5.018,1.912 6.931,-0c1.912,-1.913 1.912,-5.019 -0,-6.931l-6.799,-6.799Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.108,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c-0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c-0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'dark'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_dark"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.901,2.196 -4.901,4.901c0,2.705 2.197,4.901 4.901,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.662,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.989,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.732,61.103c1.91,-1.91 1.91,-5.011 0,-6.921l-0.009,-0.01c-1.91,-1.91 -5.012,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.909,1.91 5.011,1.91 6.92,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.672,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.52,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l-0,-0.01c-0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.901,2.196 -4.901,4.901c0,2.704 2.197,4.9 4.901,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.73,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 -0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.098,34.623c-2.699,0 -4.891,2.192 -4.891,4.892l-0,0.019c-0,2.699 2.192,4.891 4.891,4.891c2.7,0 4.892,-2.192 4.892,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.892,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'darkest'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_darkest"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><path d="M39.315,23.791c8.684,-0 15.734,7.05 15.734,15.733c0,8.684 -7.05,15.734 -15.734,15.734c-8.683,0 -15.733,-7.05 -15.733,-15.734c-0,-8.683 7.05,-15.733 15.733,-15.733Zm0,4.737c6.069,0 10.997,4.927 10.997,10.996c-0,6.069 -4.928,10.996 -10.997,10.996c-6.068,0 -10.996,-4.927 -10.996,-10.996c0,-6.069 4.928,-10.996 10.996,-10.996Z" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.216,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.9,2.196 -4.9,4.901c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.666,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.99,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.737,61.103c1.909,-1.91 1.909,-5.011 -0,-6.921l-0.01,-0.01c-1.91,-1.91 -5.011,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.91,1.91 5.011,1.91 6.921,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.676,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.524,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l0,-0.01c0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.216,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901c-0,2.704 2.196,4.9 4.9,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.734,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.103,34.623c-2.7,0 -4.892,2.192 -4.892,4.892l-0,0.019c-0,2.699 2.192,4.891 4.892,4.891c2.699,0 4.891,-2.192 4.891,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.891,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>
</a>

<script>
(function() {
    const LOCAL_STORAGE_KEY = 'piccoloThemeMode'

    var initialMode = localStorage.getItem(LOCAL_STORAGE_KEY)

    if (initialMode) {
        // Make sure the value in local storage is valid
        if (['light', 'dark', 'darkest'].indexOf(initialMode) == -1) {
            initialMode = 'light'
            localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
        }
    } else {
        // Check if the client prefers dark mode
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            initialMode = 'dark'
        } else {
            initialMode = 'light'
        }
        localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
    }

    document.documentElement.dataset.mode = initialMode

    PetiteVue.createApp({
        'mode': initialMode,
        handleClick() {
            let currentMode = this.mode

            if (currentMode == 'light') {
                this.mode = 'dark'
            } else if (currentMode == 'dark') {
                this.mode = 'darkest'
            } else if (currentMode == 'darkest') {
                this.mode = 'light'
            }

            document.documentElement.dataset.mode = this.mode
            localStorage.setItem(LOCAL_STORAGE_KEY, this.mode)

            console.log(this.mode)
        }
    }).mount('#mode_toggle')
})()
</script>
            <p class="mobile_search_link">
                <a href="search.html" title="Search">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 65 64" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2">
                        <path d="M14.873 40.009c-2.315-3.943-3.642-8.532-3.642-13.429C11.231 11.91 23.141 0 37.811 0s26.58 11.91 26.58 26.58-11.91 26.58-26.58 26.58a26.44 26.44 0 0 1-14.277-4.161L9.739 62.794a3.12 3.12 0 0 1-4.413 0L.913 58.382c-1.217-1.218-1.217-3.196 0-4.413l13.96-13.96zM37.811 8.054c10.225 0 18.526 8.301 18.526 18.526s-8.301 18.526-18.526 18.526-18.526-8.301-18.526-18.526S27.586 8.054 37.811 8.054z" fill="#fff" />
                    </svg>
                </a>
            </p>
        

        <div class="searchbox_wrapper">
            
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
    </nav>
</div>

    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Quickstart.html">Quickstart</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">User Guide</a></li>
</ul>

        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="user-guide">
<h1>User Guide<a class="headerlink" href="#user-guide" title="Permalink to this heading">¶</a></h1>
<p>This user guide explains how to use the Medical Time-Series Data Analysis Toolkit, a powerful tool designed to assist healthcare professionals in analyzing and interpreting time-series medical data. The toolkit is specifically tailored for extracting meaningful features from patient records over time, enabling doctors to gain insights into the progression of diseases, the effectiveness of treatments, and other critical clinical outcomes.</p>
<section id="prerequisites">
<h2><strong>Prerequisites</strong><a class="headerlink" href="#prerequisites" title="Permalink to this heading">¶</a></h2>
<p>Before you begin, ensure you have the following installed:</p>
<ul class="simple">
<li><p>Python 3.7 or higher</p></li>
<li><p>pandas</p></li>
<li><p>numpy</p></li>
<li><p>scikit-learn</p></li>
<li><p>matplotlib</p></li>
<li><p>seaborn (optional for advanced visualizations)</p></li>
<li><p>xgboost (for using the XGBoost model)</p></li>
<li><p>lifelines (for survival analysis models like Cox Proportional Hazards)</p></li>
<li><p>imbalanced-learn (for data balancing techniques like SMOTE)</p></li>
</ul>
<p>You can install the necessary libraries using pip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pandas</span> <span class="n">numpy</span> <span class="n">scikit</span><span class="o">-</span><span class="n">learn</span> <span class="n">matplotlib</span> <span class="n">seaborn</span> <span class="n">xgboost</span> <span class="n">lifelines</span> <span class="n">imbalanced</span><span class="o">-</span><span class="n">learn</span>
</pre></div>
</div>
</section>
<section id="input-data-format">
<h2><strong>Input Data Format</strong><a class="headerlink" href="#input-data-format" title="Permalink to this heading">¶</a></h2>
<p>To use the <code class="docutils literal notranslate"><span class="pre">FeModEvaluator</span></code> class effectively, your input data should adhere to the following format. Below is a guide based on a provided sample dataset.</p>
<section id="sample-data-format">
<h3><strong>Sample Data Format</strong><a class="headerlink" href="#sample-data-format" title="Permalink to this heading">¶</a></h3>
<p>The dataset should be structured as a pandas DataFrame with the following columns:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">**Patient_ID**</span></code>: A unique identifier for each patient (e.g., <code class="docutils literal notranslate"><span class="pre">PATIENT_ID</span></code> in the example).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**Record_Time**</span></code>: The date and time of the record (e.g., <code class="docutils literal notranslate"><span class="pre">RE_DATE</span></code> in the example) in a format that can be parsed by <code class="docutils literal notranslate"><span class="pre">pandas.to_datetime</span></code> (e.g., <code class="docutils literal notranslate"><span class="pre">YYYY-MM-DD</span> <span class="pre">HH:MM:SS</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**Outcome**</span></code>: The outcome variable, indicating the result of the treatment or condition.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**Clinical</span> <span class="pre">Measurements**</span></code>: Clinical data, such as lab values or measurements (e.g., <code class="docutils literal notranslate"><span class="pre">eGFR</span></code>, <code class="docutils literal notranslate"><span class="pre">creatinine</span></code> in the example).</p></li>
</ul>
<section id="example-rows-covid-19-dataset">
<h4><strong>Example Rows（covid_19 dataset）</strong><a class="headerlink" href="#example-rows-covid-19-dataset" title="Permalink to this heading">¶</a></h4>
<p>| PATIENT_ID | RE_DATE | outcome | eGFR | creatinine | … (other measurements) |</p>
<p>| — | — | — | — | — | — |</p>
<p>| 1 | 2020-01-31 01:09:00 | 0 | NaN | NaN | … |</p>
<p>| 1 | 2020-01-31 01:25:00 | 0 | NaN | 136.0 | … |</p>
<p>| 1 | 2020-01-31 01:44:00 | 0 | 46.6 | 130.0 | … |</p>
<p>| … | … | … | … | … | … |</p>
</section>
</section>
</section>
<section id="usage">
<h2><strong>Usage</strong><a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<section id="class-initialization">
<h3><strong>Class Initialization</strong><a class="headerlink" href="#class-initialization" title="Permalink to this heading">¶</a></h3>
<p>To utilize this data structure with the <code class="docutils literal notranslate"><span class="pre">FeModEvaluator</span></code> class, you need to initialize the class as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">mtslearn.feature_extraction</span> <span class="k">as</span> <span class="nn">fe</span>

<span class="c1"># Load your data into a DataFrame</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;path/to/your/375_patients_example.xlsx&#39;</span>  <span class="c1"># Replace with your file path</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

<span class="c1"># Class Initialization</span>
<span class="n">fe</span> <span class="o">=</span> <span class="n">fe</span><span class="o">.</span><span class="n">FeModEvaluator</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span> 
    <span class="n">group_col</span><span class="o">=</span><span class="s1">&#39;PATIENT_ID&#39;</span><span class="p">,</span> 
    <span class="n">time_col</span><span class="o">=</span><span class="s1">&#39;RE_DATE&#39;</span><span class="p">,</span>  
    <span class="n">outcome_col</span><span class="o">=</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span> 
    <span class="n">value_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;eGFR&#39;</span><span class="p">,</span> <span class="s1">&#39;creatinine&#39;</span><span class="p">],</span> 
    <span class="n">selected_features</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">],</span> 
    <span class="n">include_duration</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Parameters:</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">**df**</span></code>: The DataFrame containing your patient data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**group_col**</span></code>: Column name to group the data by (e.g., patient ID).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**time_col**</span></code>: Column name representing the time of each record. This column should be in a format that can be parsed by <code class="docutils literal notranslate"><span class="pre">pandas.to_datetime</span></code>.</p>
<ul>
<li><p>Common formats include:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">YYYY-MM-DD</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">YYYY-MM-DD</span> <span class="pre">HH:MM:SS</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MM/DD/YYYY</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MM/DD/YYYY</span> <span class="pre">HH:MM:SS</span></code></p></li>
</ul>
</li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">**outcome_col**</span></code>: Column name representing the outcome variable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**value_cols**</span></code>: List of columns to extract features from.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**selected_features**</span></code>: List of selected features for model training (optional). If not provided, it defaults to the same columns as <code class="docutils literal notranslate"><span class="pre">value_cols</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**include_duration**</span></code>: Boolean indicating whether to include the duration feature (calculated as the difference in days between the first and last timestamps for each group).</p></li>
</ul>
</li>
</ul>
</section>
<section id="feature-extraction-methods">
<h3><strong>Feature Extraction Methods</strong><a class="headerlink" href="#feature-extraction-methods" title="Permalink to this heading">¶</a></h3>
<section id="extracting-basic-features">
<h4><strong>1. Extracting Basic Features</strong><a class="headerlink" href="#extracting-basic-features" title="Permalink to this heading">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">extract_basic_features</span></code> method extracts statistical features from a series of values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">features</span> <span class="o">=</span> <span class="n">fe</span><span class="o">.</span><span class="n">extract_basic_features</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">fill_method</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Parameters:</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">**values**</span></code>: The series of values from which to extract features.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**fill_method**</span></code>: Method to fill missing values (<code class="docutils literal notranslate"><span class="pre">'mean'</span></code>, <code class="docutils literal notranslate"><span class="pre">'median'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'zero'</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**fill**</span></code>: Whether to fill missing values.</p></li>
</ul>
</li>
<li><p><strong>Features Extracted:</strong></p>
<ul>
<li><p>Mean</p></li>
<li><p>Median</p></li>
<li><p>Standard deviation</p></li>
<li><p>Minimum</p></li>
<li><p>Maximum</p></li>
<li><p>Difference between the last and first measurements (<code class="docutils literal notranslate"><span class="pre">diff_last_first</span></code>)</p></li>
<li><p>Count of missing values (<code class="docutils literal notranslate"><span class="pre">missing_count</span></code>)</p></li>
<li><p>Ratio of missing values (<code class="docutils literal notranslate"><span class="pre">missing_ratio</span></code>)</p></li>
</ul>
</li>
</ul>
</section>
<section id="extracting-features-from-dataframe">
<h4><strong>2. Extracting Features from DataFrame</strong><a class="headerlink" href="#extracting-features-from-dataframe" title="Permalink to this heading">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">extract_features_from_dataframe</span></code> method extracts features for each group in the DataFrame:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">features_df</span> <span class="o">=</span> <span class="n">fe</span><span class="o">.</span><span class="n">extract_features_from_dataframe</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill_method</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Parameters:</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">**fill_method**</span></code>: Method to fill missing values.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**fill**</span></code>: Whether to fill missing values.</p></li>
</ul>
</li>
<li><p><strong>Returns</strong>: A DataFrame where each row represents a group (e.g., a patient) with extracted features.</p></li>
</ul>
</section>
</section>
<section id="preparing-data-for-modeling">
<h3><strong>Preparing Data for Modeling</strong><a class="headerlink" href="#preparing-data-for-modeling" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">prepare_data</span></code> method prepares the data for modeling by extracting features, handling missing values, balancing the dataset, and splitting it into training and testing sets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">fe</span><span class="o">.</span><span class="n">prepare_data</span><span class="p">(</span>
    <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
    <span class="n">fill_method</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> 
    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> 
    <span class="n">balance_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
    <span class="n">cross_val</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Parameters:</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">**fill_method**</span></code>: Method to fill missing values.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**fill**</span></code>: Whether to fill missing values.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**test_size**</span></code>: Proportion of the data to be used as the test set.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**balance_data**</span></code>: Whether to balance the data using SMOTE.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**cross_val**</span></code>: Whether to prepare data for cross-validation.</p></li>
</ul>
</li>
<li><p><strong>Returns</strong>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">**X_train,</span> <span class="pre">X_test**</span></code>: Feature sets for training and testing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**y_train,</span> <span class="pre">y_test**</span></code>: Outcome sets for training and testing.</p></li>
</ul>
</li>
</ul>
</section>
<section id="evaluating-models">
<h3><strong>Evaluating Models</strong><a class="headerlink" href="#evaluating-models" title="Permalink to this heading">¶</a></h3>
<section id="evaluating-classification-models">
<h4><strong>1. Evaluating Classification Models</strong><a class="headerlink" href="#evaluating-classification-models" title="Permalink to this heading">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">evaluate_model</span></code> method evaluates classification models and plots ROC curves and confusion matrices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fe</span><span class="o">.</span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_prob</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Parameters:</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">**model**</span></code>: Trained model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**X_test**</span></code>: Test set features.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**y_test**</span></code>: True labels for the test set.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**y_prob**</span></code>: Predicted probabilities for the positive class.</p></li>
</ul>
</li>
<li><p><strong>Outputs</strong>:</p>
<ul>
<li><p>Accuracy</p></li>
<li><p>Precision</p></li>
<li><p>Recall</p></li>
<li><p>F1 Score</p></li>
<li><p>AUC (if applicable)</p></li>
</ul>
</li>
</ul>
</section>
<section id="evaluating-regression-models">
<h4><strong>2. Evaluating Regression Models</strong><a class="headerlink" href="#evaluating-regression-models" title="Permalink to this heading">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">evaluate_lasso_model</span></code> method evaluates regression models:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fe</span><span class="o">.</span><span class="n">evaluate_lasso_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Parameters:</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">**model**</span></code>: Trained model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**X_test**</span></code>: Test set features.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**y_test**</span></code>: True labels for the test set.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**y_pred**</span></code>: Predicted values.</p></li>
</ul>
</li>
<li><p><strong>Outputs</strong>:</p>
<ul>
<li><p>Mean Squared Error</p></li>
<li><p>R² Score</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="running-the-pipeline">
<h3><strong>Running the Pipeline</strong><a class="headerlink" href="#running-the-pipeline" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">run</span></code> method combines all the steps into a single pipeline for ease of use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fe</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;logit&#39;</span><span class="p">,</span> 
    <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
    <span class="n">fill_method</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> 
    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> 
    <span class="n">balance_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
    <span class="n">cross_val</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span>
<span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Parameters:</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">**model_type**</span></code>: Type of model to use (<code class="docutils literal notranslate"><span class="pre">'logit'</span></code>, <code class="docutils literal notranslate"><span class="pre">'cox'</span></code>, <code class="docutils literal notranslate"><span class="pre">'xgboost'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'lasso'</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**fill_method**</span></code>: Method to fill missing values.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**fill**</span></code>: Whether to fill missing values.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**test_size**</span></code>: Proportion of the data to be used as the test set.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**balance_data**</span></code>: Whether to balance the data using SMOTE.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**cross_val**</span></code>: Whether to perform cross-validation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**n_splits**</span></code>: Number of splits for cross-validation (default is 5).</p></li>
</ul>
</li>
</ul>
</section>
<section id="example-usage">
<h3><strong>Example Usage</strong><a class="headerlink" href="#example-usage" title="Permalink to this heading">¶</a></h3>
<p>Here’s an example of how to use the <code class="docutils literal notranslate"><span class="pre">FeModEvaluator</span></code> class in practice:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">mtslearn.feature_extraction</span> <span class="k">as</span> <span class="nn">fe</span>

<span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;path/to/your/375_patients_example.xlsx&#39;</span>  <span class="c1"># Replace with your actual file path</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>  <span class="c1"># Read the Excel file located at file_path</span>

<span class="c1"># Fill missing values in the PATIENT_ID column using the forward fill method</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;PATIENT_ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Optionally print the first 50 rows of the DataFrame to check the data</span>
<span class="c1"># print(df.head(50))</span>

<span class="c1"># Ensure the data is sorted by PATIENT_ID and RE_DATE to maintain chronological order</span>
<span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PATIENT_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;RE_DATE&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Initialize FeModEvaluator class for feature extraction and model evaluation</span>
<span class="n">fe</span> <span class="o">=</span> <span class="n">fe</span><span class="o">.</span><span class="n">FeModEvaluator</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span> 
    <span class="n">group_col</span><span class="o">=</span><span class="s1">&#39;PATIENT_ID&#39;</span><span class="p">,</span> 
    <span class="n">time_col</span><span class="o">=</span><span class="s1">&#39;RE_DATE&#39;</span><span class="p">,</span> 
    <span class="n">outcome_col</span><span class="o">=</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span> 
    <span class="n">value_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;eGFR&#39;</span><span class="p">,</span> <span class="s1">&#39;creatinine&#39;</span><span class="p">],</span> 
    <span class="n">selected_features</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">],</span> 
    <span class="n">include_duration</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Run the feature extraction and model evaluation using XGBoost as the model</span>
<span class="n">fe</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;xgboost&#39;</span><span class="p">,</span> 
    <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
    <span class="n">fill_method</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> 
    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> 
    <span class="n">balance_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
    <span class="n">plot_importance</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Example calls to the describe_data method to visualize the data</span>
<span class="n">fe</span><span class="o">.</span><span class="n">describe_data</span><span class="p">(</span><span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;boxplot&#39;</span><span class="p">,</span> <span class="n">value_col</span><span class="o">=</span><span class="s1">&#39;eGFR&#39;</span><span class="p">)</span>  <span class="c1"># Generate a boxplot for the eGFR column</span>
<span class="n">fe</span><span class="o">.</span><span class="n">describe_data</span><span class="p">(</span><span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;correlation_matrix&#39;</span><span class="p">,</span> <span class="n">feature1</span><span class="o">=</span><span class="s1">&#39;eGFR&#39;</span><span class="p">,</span> <span class="n">feature2</span><span class="o">=</span><span class="s1">&#39;creatinine&#39;</span><span class="p">)</span>  <span class="c1"># Generate a correlation matrix between eGFR and creatinine</span>
</pre></div>
</div>
</section>
<section id="presentation-of-results-partial">
<h3>Presentation of Results (Partial)<a class="headerlink" href="#presentation-of-results-partial" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>Characterization of data</strong></p></li>
</ul>
<p><img alt="_images/1.png" src="_images/1.png" />
<img alt="_images/2.png" src="_images/2.png" /></p>
<ul class="simple">
<li><p><strong>Evaluation of predictive effects</strong></p></li>
</ul>
<p><img alt="_images/3.png" src="_images/3.png" />
<img alt="_images/4.png" src="_images/4.png" /></p>
<ul class="simple">
<li><p><strong>Calculation of feature importance</strong></p></li>
</ul>
<p><img alt="_images/5.png" src="_images/5.png" />
<img alt="_images/6.png" src="_images/6.png" /></p>
</section>
<section id="conclusion">
<h3><strong>Conclusion</strong><a class="headerlink" href="#conclusion" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">FeModEvaluator</span></code> class provides a comprehensive framework for feature extraction, data preparation, and model evaluation tailored to time-series medical data. The class simplifies the workflow, making it easier to extract meaningful insights from complex datasets and evaluate predictive models effectively.</p>
<section id="tips-for-best-practices">
<h4><strong>Tips for Best Practices:</strong><a class="headerlink" href="#tips-for-best-practices" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p><strong>Data Preprocessing</strong>: Ensure that your data is clean and properly formatted before feeding it into the <code class="docutils literal notranslate"><span class="pre">FeModEvaluator</span></code> class. This includes handling missing values and ensuring that timestamps are in a consistent format.</p></li>
<li><p><strong>Feature Selection</strong>: While the toolkit provides default statistical features, consider selecting additional features that are relevant to your specific medical application.</p></li>
<li><p><strong>Model Choice</strong>: The toolkit supports multiple model types, including logistic regression, Cox proportional hazards, XGBoost, and Lasso regression. Choose the model that best suits your prediction problem.</p></li>
<li><p><strong>Cross-Validation</strong>: Utilize cross-validation, especially when working with small datasets, to ensure that your model generalizes well to unseen data.</p></li>
<li><p><strong>Visualizations</strong>: Use the built-in visualization methods to explore and understand the relationships between clinical features in your dataset.</p></li>
</ul>
<p>By following this guide, you can effectively use the Medical Time-Series Data Analysis Toolkit to analyze patient data, extract critical features, and evaluate predictive models, leading to more informed clinical decisions and research insights.</p>
</section>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
    
        <div id="show_right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&lt;</span><span>Page contents</span></a></p>
        </div>

        <div id="right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&gt;</span><span>Page contents:</span></a></p>
            <div class="page_toc">
                <ul>
<li><a class="reference internal" href="#">User Guide</a><ul>
<li><a class="reference internal" href="#prerequisites"><strong>Prerequisites</strong></a></li>
<li><a class="reference internal" href="#input-data-format"><strong>Input Data Format</strong></a><ul>
<li><a class="reference internal" href="#sample-data-format"><strong>Sample Data Format</strong></a><ul>
<li><a class="reference internal" href="#example-rows-covid-19-dataset"><strong>Example Rows（covid_19 dataset）</strong></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#usage"><strong>Usage</strong></a><ul>
<li><a class="reference internal" href="#class-initialization"><strong>Class Initialization</strong></a></li>
<li><a class="reference internal" href="#feature-extraction-methods"><strong>Feature Extraction Methods</strong></a><ul>
<li><a class="reference internal" href="#extracting-basic-features"><strong>1. Extracting Basic Features</strong></a></li>
<li><a class="reference internal" href="#extracting-features-from-dataframe"><strong>2. Extracting Features from DataFrame</strong></a></li>
</ul>
</li>
<li><a class="reference internal" href="#preparing-data-for-modeling"><strong>Preparing Data for Modeling</strong></a></li>
<li><a class="reference internal" href="#evaluating-models"><strong>Evaluating Models</strong></a><ul>
<li><a class="reference internal" href="#evaluating-classification-models"><strong>1. Evaluating Classification Models</strong></a></li>
<li><a class="reference internal" href="#evaluating-regression-models"><strong>2. Evaluating Regression Models</strong></a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-the-pipeline"><strong>Running the Pipeline</strong></a></li>
<li><a class="reference internal" href="#example-usage"><strong>Example Usage</strong></a></li>
<li><a class="reference internal" href="#presentation-of-results-partial">Presentation of Results (Partial)</a></li>
<li><a class="reference internal" href="#conclusion"><strong>Conclusion</strong></a><ul>
<li><a class="reference internal" href="#tips-for-best-practices"><strong>Tips for Best Practices:</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
        </div>
    

      <div class="clearer"></div>
    </div>
    <div class="button_nav_wrapper">
        <div class="button_nav">
            <div class="left">
                
                <a href="Quickstart.html">
                    <span class="icon">&lt;</span><span>Quickstart</span></a>
                
            </div>

            <div class="right">
                
            </div>
        </div>
    </div>


    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, tangoz.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    </div>

<p id="theme_credit">Styled using the <a href="https://github.com/piccolo-orm/piccolo_theme">Piccolo Theme</a></p>
  </body>
</html>